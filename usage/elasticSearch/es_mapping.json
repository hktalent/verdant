curl -X PUT 'http://192.168.0.198:9200/cgpboss/' - d ' {
    "settings": {
        "index": {
            "number_of_shards": 3,
            "number_of_replicas": 1
        }
    }
}
'

curl -X PUT 192.168.112.172:9200/_template/template_cgpboss_day -d ' 
{
    "template": "cgpboss_day_*",
    "order": 0,
    "settings": {
        "index": {
            "number_of_shards": 3,
            "number_of_replicas": 1
        }
    },
    "mappings": {
        "stat_flow": {
            "_source": {
                "enabled": true
            },
            "_all": {
                "enabled": false
            },
            "properties": {
                "cid": {
                    "type": "string",
                    "index": "not_analyzed"
                },
                "instanceId": {
                    "type": "string",
                    "index": "not_analyzed"
                },
                "ispId": {
                    "type": "string",
                    "index": "not_analyzed"
                },
                "time": {
                    "type": "date"
                },
                "dip": {
                    "type": "ip"
                },
                "atk": {
                    "type": "nested",
                    "properties": {
                        "packets": {
                            "type": "long"
                        },
                        "bytes": {
                            "type": "long"
                        },
                        "forwardPackets": {
                            "type": "long"
                        },
                        "forwardBytes": {
                            "type": "long"
                        },
                        "category": {
                            "type": "string",
                            "index": "not_analyzed"
                        }
                    }
                }
            }
        },
        "monitor_oid": {
            "time": {
                "type": "date",
                "format": "strict_date_optional_time||epoch_millis"
            },
            "ip": {
                "type": "ip",
            },
            "oids": {
                "type": "nested",
                "properties": {
                    "oid": {
                        "type": "string",
                        "index": "not_analyzed"
                    },
                    "desc": {
                        "type": "string",
                        "index": "not_analyzed"
                    },
                    "value": {
                        "type": "string",
                        "index": "not_analyzed"
                    }
                }
            }
        }
    }
}
'

curl -X PUT 'http://192.168.0.198:9200/cgpboss/_mapping/stat_flow_summary' - d ' 
{
    "_all": {
        "enabled": false
    },
    "properties": {
        "cid": {
            "type": "string",
            "index": "not_analyzed"
        },
        "instanceId": {
            "type": "string",
            "index": "not_analyzed"
        },
        "ispId": {
            "type": "string",
            "index": "not_analyzed"
        },
        "time": {
            "type": "date"
        },
        "dip": {
            "type": "ip"
        },
        "atk": {
            "type": "nested",
            "properties": {
                "packets": {
                    "type": "long"
                },
                "bytes": {
                    "type": "long"
                },
                "forwardPackets": {
                    "type": "long"
                },
                "forwardBytes": {
                    "type": "long"
                },
                "pps": {
                    "type": "long"
                },
                "bps": {
                    "type": "long"
                },
                "fpps": {
                    "type": "long"
                },
                "fbps": {
                    "type": "long"
                },
                "category": {
                    "type": "string",
                    "index": "not_analyzed"
                }
            }
        }
    }
}
'


curl - XPUT 'http://192.168.0.198:9200/cgpboss/_mapping/attack_alarm/' - d '
{
    "_all": {
        "enabled": false
    },
    "properties": {
        "attackId": {
            "type": "string",
            "index": "not_analyzed"
        },
        "instanceId": {
            "type": "string",
            "index": "not_analyzed"
        },
        "customerId": {
            "type": "string",
            "index": "not_analyzed"
        },
        "dstIp": {
            "type": "string",
            "index": "not_analyzed"
        },
        "attackStatus": {
            "type": "string",
            "index": "not_analyzed"
        },
        "attackType": {
            "type": "string",
            "index": "not_analyzed"
        },
        "message": {
            "type": "string",
            "index": "not_analyzed"
        },
        "trafficRate": {
            "type": "double"
        },
        "packetRate": {
            "type": "double"
        },
        "alarmLevel": {
            "type": "integer"
        },
        "alarmType": {
            "type": "integer"
        },
        "startTime": {
            "type": "date",
            "format": "yyyy-MM-dd HH:mm:ss||strict_date_optional_time||epoch_millis"
        },
        "endTime": {
            "type": "date",
            "format": "yyyy-MM-dd HH:mm:ss||strict_date_optional_time||epoch_millis"
        },
        "duration": {
            "type": "long"
        },
        "timestamp": {
            "type": "date"
        },
        "maxTrafficRate": {
            "type": "double"
        },
        "maxPacketRate": {
            "type": "double"
        }
    }
}
'

curl - XPUT 'http://192.168.112.172:9200/cgpboss_day_20160120/_mapping/monitor_oid/' - d ' {
    "_all": {
        "enabled": false
    },
    "properties": {
        "time": {
            "type": "date",
            "format": "strict_date_optional_time||epoch_millis"
        },
        "ip": {
            "type": "ip",
            "index": "not_analyzed"
        },
        "oids": {
            "type": "nested",
            "properties": {
                "oid": {
                    "type": "string",
                    "index": "not_analyzed"
                },
                "desc": {
                    "type": "string",
                    "index": "not_analyzed"
                },
                "value": {
                    "type": "string",
                    "index": "not_analyzed"
                }
            }
        }
    }
}
'